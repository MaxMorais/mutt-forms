var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),inherits=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},possibleConstructorReturn=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},Validator=function(){function t(e){classCallCheck(this,t),this.error=null,this.messages={required:"This field is required."},Object.assign(this.messages,e)}return t.prototype.validate=function(t){return!0},t}(),RequiredValidator=function(t){function e(){return classCallCheck(this,e),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(e,t),e.prototype.validate=function(t){return!(!t&&0!==t)||(this.error=this.messages.required,!1)},e}(Validator),BooleanRequiredValidator=function(t){function e(){return classCallCheck(this,e),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(e,t),e.prototype.validate=function(t){return!0===t||!1===t||(this.error=this.messages.required,!1)},e}(Validator),BooleanTrueValidator=function(t){function e(){return classCallCheck(this,e),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(e,t),e.prototype.validate=function(t){return!0===t||(this.error=this.messages.required,!1)},e}(Validator),LengthValidator=function(t){function e(r){var i=r.min,n=void 0===i?null:i,o=r.max,s=void 0===o?null:o,a=r.messages,l=void 0===a?null:a;classCallCheck(this,e);var u=possibleConstructorReturn(this,t.call(this,l));return u.min=n,u.max=s,u.messages.hasOwnProperty("minLength")||(u.messages.minLength="Length must be at least "+u.min+"!"),u.messages.hasOwnProperty("maxLength")||(u.messages.maxLength="Length must be no more than "+u.max+"!"),u}return inherits(e,t),e.prototype.validate=function(t){return t?this.min&&t.length<this.min?(this.error=this.messages.minLength,!1):!(this.max&&t.length>this.max)||(this.error=this.messages.maxLength,!1):(this.error=this.messages.required,!1)},e}(Validator),IntegerValidator=function(t){function e(r){classCallCheck(this,e);var i=possibleConstructorReturn(this,t.call(this,r));return i.messages.hasOwnProperty("intRequired")||(i.messages.intRequired="Value must be an integer"),i}return inherits(e,t),e.prototype.validate=function(t){return!t||!isNaN(t)||(this.error=this.messages.intRequired,!1)},e}(Validator),RegexValidator=function(t){function e(r,i){classCallCheck(this,e);var n=possibleConstructorReturn(this,t.call(this,i));return n.pattern=r,n.messages.hasOwnProperty("invalidPattern")||(n.messages.invalidPattern="Value must match the pattern: "+n.pattern),n}return inherits(e,t),e.prototype.validate=function(t){return t?!!t.match(this.pattern)||(this.error=this.messages.invalidPattern,!1):(this.error=this.messages.required,!1)},e}(Validator),Field=function(){function t(e){var r=e.id,i=e.name,n=e.label,o=void 0===n?null:n,s=e.initial,a=void 0===s?null:s,l=e.widget,u=void 0===l?null:l,d=e.validators,h=void 0===d?[]:d,c=e.attribs,p=void 0===c?{}:c,f=e.description,y=void 0===f?null:f,b=e.options,v=void 0===b?{}:b,m=e.order,g=void 0===m?null:m,A=e.parent,k=void 0===A?null:A;classCallCheck(this,t),this.id=r,this.name=i,this.label=o,this.description=y,this.attribs=p,this.options=v,this.validators=h,this.sortOrder=g,this.locked=!1,this.parent=k,this.label||(this.label=this.name),this.initOptions();var C=this.getWidget();u&&(C=u),this.widget=new C(this,this.type,this.id,this.name,this.label,this.attribs,this.options,a),this._errors=[]}return t.prototype.initOptions=function(){this.options.hasOwnProperty("order")&&(this.sortOrder=this.options.order),this.options.hasOwnProperty("label")&&(this.label=this.options.label),this.options.hasOwnProperty("description")&&(this.description=this.options.description)},t.prototype.render=function(){return this.widget.render()},t.prototype.destroy=function(){return this.widget.destroy()},t.prototype.postRender=function(){this.widget.postRender()},t.prototype.validate=function(){this.refreshValidationState();var t=this.value,e=this.validators,r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;if(!o.validate(t)){this.errors=o.error;break}}return!(this.errors.length>0)||(this.widget.refreshErrorState(this.errors),!1)},t.prototype.lock=function(){return!this.locked&&(this.widget.lock(),this.locked=!0,!0)},t.prototype.unlock=function(){return!!this.locked&&(this.widget.unlock(),this.locked=!1,!0)},t.prototype.refreshValidationState=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._errors=[],this.widget.errors=[],t&&this.widget.refreshErrorState([])},t.prototype.getWidget=function(){return Mutt.config.getWidget("text")},t.prototype.getSortOrder=function(){return this.sortOrder},t.prototype.setSortOrder=function(t){this.sortOrder=t},t.prototype.toString=function(){return"Field <"+this.name+" "+this.type+">"},t.prototype.updateId=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.id;this.id=t,e&&this.widget.updateId(r,t)},t.prototype.updateName=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.name=t,e&&this.widget.updateName(t)},t.new=function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s={id:t,name:e,options:i,attribs:{},parent:n},a=null,l=[];if(r.description&&(s.description=r.description),r.title&&(s.label=r.title),r.default&&(s.initial=r.default),r.enum){var u=[],d=r.enum,h=Array.isArray(d),c=0;for(d=h?d:d[Symbol.iterator]();;){var p;if(h){if(c>=d.length)break;p=d[c++]}else{if((c=d.next()).done)break;p=c.value}var f=p;u.push([f,f])}s.choices=u,a=Mutt.config.getField("enum")}if(i.hasOwnProperty("hidden")&&i.hidden&&(s.widget=Mutt.config.getWidget("hidden")),r.format&&Mutt.config.hasWidget(r.format)&&(s.widget=Mutt.config.getWidget(r.format)),i.widget&&Mutt.config.hasWidget(i.widget)&&(s.widget=Mutt.config.getWidget(i.widget)),r.items&&(s.items=r.items),r.properties&&(s.properties=r.properties),(o||i.hasOwnProperty("required")&&i.required)&&("boolean"===r.type?l.push(new BooleanRequiredValidator):l.push(new RequiredValidator),s.attribs.required="true"),r.required&&(s.required=r.required),r.hasOwnProperty("minLength")&&l.push(new LengthValidator({min:r.minLength})),r.hasOwnProperty("maxLength")&&l.push(new LengthValidator({max:r.maxLength})),i.validators&&l.unshift.apply(l,i.validators),r.hasOwnProperty("minItems")&&(s.minItems=r.minItems),r.hasOwnProperty("maxItems")&&(s.maxItems=r.maxItems),s.validators=l,!a){if(!Mutt.config.hasField(r.type))return null;a=Mutt.config.getField(r.type)}return new a(s)},createClass(t,[{key:"type",get:function(){var t=this.constructor.name.toLowerCase();return"field"!==t?t.replace("field",""):t},set:function(t){throw new Error("Unable to set type on a field instance!")}},{key:"value",get:function(){return this.widget.getValue()},set:function(t){this.widget.setValue(t)}},{key:"errors",get:function(){return this._errors},set:function(t){this._errors.push(t)}}]),t}(),Fieldset=function(){function t(e){var r=e.label,i=void 0===r?null:r,n=e.name,o=void 0===n?null:n;classCallCheck(this,t),this.name=o,this.label=i,this.fields=[],this.errors={}}return t.prototype.addField=function(t){this.fields.push(t)},t.prototype.hasField=function(t){for(var e in this.fields)if(e.name===t)return!0;return!1},t.prototype.data=function(){var t={},e=this.fields,r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;t[o.name]=o.value}return t},t.prototype.populate=function(t){var e=this.fields,r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;t.hasOwnProperty(o.name)&&(o.value=t[o.name])}},t.prototype.validate=function(){var t=!0,e=this.fields,r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;o.validate()||(this.errors[o.name]=o.errors,t=!1)}return t},t.prototype.setFieldErrors=function(t){for(var e in t)this.hasField(e)&&this.getField(e)},t.prototype.setLegend=function(t){this.label=t},t.prototype.refreshValidationState=function(){this.errors={};var t=this.fields,e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}i.refreshValidationState()}},t.prototype.render=function(){var t=document.createDocumentFragment(),e=document.createElement("fieldset");if(e.classList.add("mutt-fieldset"),this.name&&e.setAttribute("name",this.name),this.label){var r=document.createElement("legend");r.textContent=this.label,e.appendChild(r)}this.fields.sort(function(t,e){return t.getSortOrder()-e.getSortOrder()});var i=this.fields,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var s;if(n){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}var a=s.render();e.appendChild(a)}return t.appendChild(e),t},t.prototype.postRender=function(){var t=this.fields,e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}i.postRender()}},t.prototype.lock=function(){var t=this.fields,e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}i.lock()}},t.prototype.unlock=function(){var t=this.fields,e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}i.unlock()}},t.prototype.getFieldByPath=function(t){var e=t.split("."),r=e.shift(),i=this.fields,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var s;if(n){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}var a=s;if(a.name===r){if(0===e.length)return a;if(a.constructor.prototype.hasOwnProperty("getFieldByPath"))return a.getFieldByPath(e.join("."))}}return null},t.new=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s={name:n};e.hasOwnProperty("title")&&(s.label=e.title),r.hasOwnProperty("form")&&r.form.hasOwnProperty("label")&&(s.label=r.form.label),null!==o&&(s.label=o),Object.assign(s,r),e.hasOwnProperty("properties")&&(e=e.properties);var a=new t(s),l=1,u=Object.keys(e),d=Array.isArray(u),h=0;for(u=d?u:u[Symbol.iterator]();;){var c;if(d){if(h>=u.length)break;c=u[h++]}else{if((h=u.next()).done)break;c=h.value}var p=c,f=p+"_field_"+l,y=e[p],b={};if(!i||Object.keys(i).includes(p)){r.fields&&r.fields.hasOwnProperty(p)&&(b=r.fields[p]),r.fieldsets&&(b.fieldsets=r.fieldsets);var v=Field.new(f,p,y,b);v&&(v.getSortOrder()||v.setSortOrder(l),a.addField(v),l++)}}return a},t}(),MuttForm=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};classCallCheck(this,t),this.schema=e,this.options={},this.callbacks={},r&&r.hasOwnProperty("form")&&(this.options=r.form),this.mount=!1,this.multipart=!1,this.id=null,this.locked=!1,this.form=null,this.fieldsets=[],this.buttons={submit:null},this.build(e,r)}return t.prototype.build=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e.hasOwnProperty("fieldsets")){var r=0,i=e.fieldsets,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var s;if(n){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}var a=s,l=null,u=null;a.hasOwnProperty("fields")&&(l=a.fields),a.hasOwnProperty("fieldsets")&&(e.fieldsets=a.fieldsets),a.options&&a.options.hasOwnProperty("label")&&(u=a.options.label);var d=Fieldset.new(t,e,l,"mutt-fieldset-"+r,u);this.fieldsets.push(d),r++}}else{var h=Fieldset.new(t,e);this.fieldsets.push(h)}},t.prototype.data=function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]){var t=[],e=this.fieldsets,r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;t.push(o.data())}return t}var s={},a=this.fieldsets,l=Array.isArray(a),u=0;for(a=l?a:a[Symbol.iterator]();;){var d;if(l){if(u>=a.length)break;d=a[u++]}else{if((u=a.next()).done)break;d=u.value}var h=d;s=Object.assign(s,h.data())}return s},t.prototype.populate=function(t){var e=this.fieldsets,r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}n.populate(t)}},t.prototype.render=function(t){var e=this;return this.mount=t,new Promise(function(t,r){var i=document.createDocumentFragment();e.form=document.createElement("form"),e.id&&e.form.setAttribute("id",e.id),e.form.setAttribute("method","POST"),e.form.setAttribute("action",""),e.form.setAttribute("class","mutt-form"),e.multipart&&e.form.setAttribute("enctype","multipart/form-data");var n=e.fieldsets,o=Array.isArray(n),s=0;for(n=o?n:n[Symbol.iterator]();;){var a;if(o){if(s>=n.length)break;a=n[s++]}else{if((s=n.next()).done)break;a=s.value}var l=a.render();e.form.appendChild(l)}var u="mutt-button",d="Submit";e.options.hasOwnProperty("buttons")&&e.options.buttons.hasOwnProperty("submit")&&(e.options.buttons.submit.hasOwnProperty("class")&&(u=u+" "+e.options.buttons.submit.class),e.options.buttons.submit.hasOwnProperty("text")&&(d=e.options.buttons.submit.text));var h=document.createElement("div");if(h.setAttribute("class","mutt-button-wrapper"),e.options.hasOwnProperty("buttons")){var c=Object.keys(e.options.buttons),p=Array.isArray(c),f=0;for(c=p?c:c[Symbol.iterator]();;){var y;if(p){if(f>=c.length)break;y=c[f++]}else{if((f=c.next()).done)break;y=f.value}var b=y;if("submit"!==b){var v=e.options.buttons[b],m=document.createElement("button");m.setAttribute("name",b),m.setAttribute("class",v.class),m.setAttribute("type","button"),m.textContent=v.text,m.onclick=v.callback,e.buttons[b]=m,h.appendChild(m)}}}var g=document.createElement("button");g.setAttribute("class",u),g.setAttribute("type","submit"),g.textContent=d,g.onclick=function(t){return e.submit(t),!1},e.buttons.submit=g,h.appendChild(g),e.form.appendChild(h),i.appendChild(e.form),e.mount.appendChild(i);var A=e.fieldsets,k=Array.isArray(A),C=0;for(A=k?A:A[Symbol.iterator]();;){var w;if(k){if(C>=A.length)break;w=A[C++]}else{if((C=A.next()).done)break;w=C.value}w.postRender()}t(e)})},t.prototype.destroy=function(){if(this.mount){var t=this.mount.querySelector("form");return this.mount.removeChild(t),!0}return!1},t.prototype.validate=function(){var t=!0,e=[],r=this.fieldsets,i=Array.isArray(r),n=0;for(r=i?r:r[Symbol.iterator]();;){var o;if(i){if(n>=r.length)break;o=r[n++]}else{if((n=r.next()).done)break;o=n.value}var s=o;s.validate()||(e.push(s.errors),t=!1)}return Mutt.logger("Validation Complete -> Status: "+t+" -> "+JSON.stringify(e)),t},t.prototype.refreshValidationState=function(){var t=this.fieldsets,e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}i.refreshValidationState()}},t.prototype.submit=function(t){var e=!1;try{e=this.validate()}catch(t){return Mutt.logger("Unable to validate prior to submit!",t),!1}return!!e&&(Mutt.logger("Submit form"),this.callbacks.hasOwnProperty("submit")?this.callbacks.submit(this.data(),t):this.form.submit(),!0)},t.prototype.lock=function(){Mutt.log("Locking form");var t=this.fieldsets,e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}i.lock()}},t.prototype.unlock=function(){Mutt.log("Unlocking form");var t=this.fieldsets,e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}i.unlock()}},t.prototype.on=function(t,e){return this.callbacks[t]=e,this},t.prototype.setFormId=function(t){this.id=t},t.prototype.getFormId=function(){return this.id},t.prototype.setFieldErrors=function(t){var e=this.fieldsets,r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}n.setFieldErrors(t)}},t.prototype.getFieldByPath=function(t){var e=this.fieldsets,r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n.getFieldByPath(t);if(o)return o}},t}(),ArrayField=function(t){function e(r){var i=r.id,n=r.name,o=r.label,s=void 0===o?null:o,a=r.initial,l=void 0===a?null:a,u=r.widget,d=void 0===u?null:u,h=r.validators,c=void 0===h?[]:h,p=r.attribs,f=void 0===p?{}:p,y=r.description,b=void 0===y?null:y,v=r.options,m=void 0===v?{}:v,g=r.order,A=void 0===g?null:g,k=r.parent,C=void 0===k?null:k,w=r.items,F=void 0===w?{}:w,x=r.minItems,S=void 0===x?1:x,E=r.maxItems,O=void 0===E?null:E;classCallCheck(this,e);var I=possibleConstructorReturn(this,t.call(this,{id:i,name:n,label:s,initial:l,widget:d,validators:c,attribs:f,description:b,options:m,order:A,parent:C}));I.minItems=S,I.maxItems=O>S?O:S,I.itemSchema=F,I.itemOptions=m,I.slots=[];var W=!0;if(I.options.hasOwnProperty("disablePlaceholders")&&(W=!I.options.disablePlaceholders),W)for(var P in Array.from(Array(I.minItems).keys()))I.addSlot(!1);return I.validators.push(new LengthValidator({min:I.minItems,max:I.maxItems})),I._errors=[],I}return inherits(e,t),e.prototype.addSlot=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.slots.length+1,r=this.getSlotId(e),i=this.getSlotName(e),n=Object.assign({order:e},this.itemOptions),o=this.constructor.new(r,i,this.itemSchema,n,this);this.slots.push(o),t&&this.widget.hasOwnProperty("addSlot")&&this.widget.addSlot(o)},e.prototype.removeSlot=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return 0!==this.slots.length&&(this.slots.pop(),t&&this.widget.hasOwnProperty("removeSlot")&&this.widget.removeSlot(),!0)},e.prototype.spliceSlot=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(0===this.slots.length)return!1;for(var r in this.slots)r=parseInt(r),e&&r===t&&this.slots[r].destroy();for(var i in this.slots.splice(t,1),this.slots){var n=parseInt(i)+1,o=this.getSlotId(n),s=this.getSlotName(n),a=this.slots[i];a.updateId(o,e),a.updateName(s,e)}return!0},e.prototype.getSlotId=function(t){return this.id+"_item_"+t},e.prototype.getSlotName=function(t){return this.name+"_"+t},e.prototype.validate=function(){if(this.refreshValidationState(),this.validators.length>0){var t=this.validators,e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}var n=i;n.validate(this.value)||(this.errors=n.error)}}if(this.errors.length>0)return this.widget.refreshErrorState(this.errors),!1;var o=!0,s=this.slots,a=Array.isArray(s),l=0;for(s=a?s:s[Symbol.iterator]();;){var u;if(a){if(l>=s.length)break;u=s[l++]}else{if((l=s.next()).done)break;u=l.value}u.validate()||(o=!1)}return o},e.prototype.refreshValidationState=function(){t.prototype.refreshValidationState.call(this),this._errors=[]},e.prototype.postRender=function(){var t=this.slots,e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}i.postRender()}},e.prototype.getWidget=function(){return Mutt.config.getWidget("array")},e.prototype.render=function(){return this.widget.renderList(this.slots)},e.prototype.getFieldByPath=function(t){var e=t.split("."),r=parseInt(e.shift());if(isNaN(r))return null;if(r>this.slots.length)return null;var i=this.slots[r];return 0===e.length?i:i.constructor.prototype.hasOwnProperty("getFieldByPath")?i.getFieldByPath(e.join(".")):null},createClass(e,[{key:"value",get:function(){var t=[],e=this.slots,r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;t.push(o.value)}return t},set:function(t){if(!Array.isArray(t))throw new Error("Unable to set array field value(s) from non-array!");if(t.length>this.slots.length){var e=t.length-this.slots.length,r=Array(e).keys(),i=Array.isArray(r),n=0;for(r=i?r:r[Symbol.iterator]();;){if(i){if(n>=r.length)break;r[n++]}else{if((n=r.next()).done)break;n.value}this.addSlot()}}else t.length<this.slots.length&&(this.slots=this.slots.slice(0,t.length));var o=this.slots.map(function(e,r){return[e,t[r]]}),s=Array.isArray(o),a=0;for(o=s?o:o[Symbol.iterator]();;){var l;if(s){if(a>=o.length)break;l=o[a++]}else{if((a=o.next()).done)break;l=a.value}var u=l,d=u[0],h=u[1];d.value=h}}}]),e}(Field),ButtonField=function(t){function e(){return classCallCheck(this,e),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(e,t),e.prototype.getWidget=function(){return Mutt.config.getWidget("button")},e}(Field);function toBool(t){if(void 0===t||null===t)return null;if("boolean"==typeof t)return t;switch(t.toLowerCase().trim()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(t)}}var BooleanField=function(t){function e(){return classCallCheck(this,e),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(e,t),e.prototype.getWidget=function(){return Mutt.config.getWidget("checkbox")},createClass(e,[{key:"value",get:function(){return toBool(this.widget.getValue())},set:function(t){this.widget.setValue(t)}}]),e}(Field),ChoiceField=function(t){function e(r){var i=r.id,n=r.name,o=r.label,s=void 0===o?null:o,a=r.initial,l=void 0===a?null:a,u=r.widget,d=void 0===u?null:u,h=r.validators,c=void 0===h?[]:h,p=r.attribs,f=void 0===p?{}:p,y=r.description,b=void 0===y?null:y,v=r.options,m=void 0===v?{}:v,g=r.order,A=void 0===g?null:g,k=r.parent,C=void 0===k?null:k,w=r.choices,F=void 0===w?[]:w;classCallCheck(this,e);var x=possibleConstructorReturn(this,t.call(this,{id:i,name:n,label:s,initial:l,widget:d,validators:c,attribs:f,description:b,options:m,order:A,parent:C}));return x.choices=F,m.hasOwnProperty("choices")&&(x.choices=m.choices),x.widget.hasOwnProperty("setChoices")&&x.widget.setChoices(x.choices),x}return inherits(e,t),e.prototype.getWidget=function(){return this.options.hasOwnProperty("widget")&&"checkboxlist"===this.options.widget?Mutt.config.getWidget("checkboxlist"):Mutt.config.getWidget("select")},e}(Field),IntegerField=function(t){function e(r){var i=r.id,n=r.name,o=r.label,s=void 0===o?null:o,a=r.initial,l=void 0===a?null:a,u=r.widget,d=void 0===u?null:u,h=r.validators,c=void 0===h?[]:h,p=r.attribs,f=void 0===p?{}:p,y=r.description,b=void 0===y?null:y,v=r.options,m=void 0===v?{}:v,g=r.order,A=void 0===g?null:g,k=r.parent,C=void 0===k?null:k;classCallCheck(this,e);var w=possibleConstructorReturn(this,t.call(this,{id:i,name:n,label:s,initial:l,widget:d,validators:c,attribs:f,description:b,options:m,order:A,parent:C}));return w.validators.push(new IntegerValidator),w}return inherits(e,t),e.prototype.getWidget=function(){return Mutt.config.getWidget("number")},createClass(e,[{key:"value",get:function(){var t=this.widget.getValue();return t?parseInt(t):""},set:function(t){this.widget.setValue(t)}}]),e}(Field),ObjectField=function(t){function e(r){var i=r.id,n=r.name,o=r.label,s=void 0===o?null:o,a=r.initial,l=void 0===a?null:a,u=r.widget,d=void 0===u?null:u,h=r.validators,c=void 0===h?[]:h,p=r.attribs,f=void 0===p?{}:p,y=r.description,b=void 0===y?null:y,v=r.options,m=void 0===v?{}:v,g=r.order,A=void 0===g?null:g,k=r.parent,C=void 0===k?null:k,w=r.properties,F=void 0===w?{}:w,x=r.required,S=void 0===x?[]:x;classCallCheck(this,e);var E=possibleConstructorReturn(this,t.call(this,{id:i,name:n,label:s,initial:l,widget:d,validators:c,attribs:f,description:b,options:m,order:A,parent:C}));E.object={};var O=1,I=Object.keys(F),W=Array.isArray(I),P=0;for(I=W?I:I[Symbol.iterator]();;){var V;if(W){if(P>=I.length)break;V=I[P++]}else{if((P=I.next()).done)break;V=P.value}var j=V,R=n+"_"+j,_={},L=!1;E.options.hasOwnProperty(j)&&(_=m[j]),S.length>0&&-1!==S.indexOf(j)&&(L=!0);var B=E.constructor.new(R,j,F[j],_,E,L);if(!B)throw new Error("Unable to create Field on ObjectField!");B.getSortOrder()||B.setSortOrder(O),E.object[j]=B,O++}return E._errors={},E}return inherits(e,t),e.prototype.validate=function(){var t=!0,e=Object.keys(this.object),r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n,s=this.object[o];s.validate()||(this._errors[o]=s.errors,t=!1)}return t},e.prototype.refreshValidationState=function(){t.prototype.refreshValidationState.call(this),this._errors={}},e.prototype.postRender=function(){var t=Object.keys(this.object),e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}var n=i;this.object[n].postRender()}},e.prototype.getWidget=function(){return Mutt.config.getWidget("object")},e.prototype.render=function(){return this.widget.renderObject(this.object)},e.prototype.getFieldByPath=function(t){var e=t.split("."),r=e.shift(),i=Object.keys(this.object),n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var s;if(n){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}var a=s,l=this.object[a];if(l.name===r){if(0===e.length)return l;if(l.constructor.prototype.hasOwnProperty("getFieldByPath"))return l.getFieldByPath(e.join("."))}}return null},createClass(e,[{key:"value",get:function(){var t={},e=Object.keys(this.object),r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;t[o]=this.object[o].value}return t},set:function(t){if(t){if("object"!==(void 0===t?"undefined":_typeof(t)))throw new Error("Unable to set object field value(s) from non-object!");var e=Object.keys(t),r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;this.object.hasOwnProperty(o)&&(this.object[o].value=t[o])}}}},{key:"errors",get:function(){return this._errors},set:function(t){this._errors=t}}]),e}(Field),StringField=function(t){function e(){return classCallCheck(this,e),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(e,t),e.prototype.getWidget=function(){return Mutt.config.getWidget("text")},e}(Field),fields=Object.freeze({Field:Field,ArrayField:ArrayField,ButtonField:ButtonField,BooleanField:BooleanField,ChoiceField:ChoiceField,IntegerField:IntegerField,ObjectField:ObjectField,StringField:StringField}),Widget=function(){function t(e,r,i,n,o){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;classCallCheck(this,t),this._field=e,this._rendered=!1,this.type=r,this.id=i,this.name=n,this.label=o,this.attribs=s,this.options=a,this.value=l,this.locked=!1,this.errors=[]}return t.prototype.render=function(){var t=document.createDocumentFragment(),e=this.renderWrapper(),r=this.renderLabel(),i=this.renderField(),n=this.renderHelp(),o=this.renderErrors();return r&&e.appendChild(r),e.appendChild(i),n&&e.appendChild(n),o&&e.appendChild(o),t.appendChild(e),this._rendered=!0,t},t.prototype.destroy=function(){var t=this.getElementWrapper();return t.parentNode.removeChild(t),!0},t.prototype.postRender=function(){},t.prototype.lock=function(){if(this.locked)return!1;var t=this.getElementWrapper(),e=this.getElement();return t.removeChild(e),this.locked=!0,!0},t.prototype.unlock=function(){if(!this.locked)return!1;var t=this.getElementWrapper(),e=this.getElement();t.removeChild(e);var r=this.renderField();return t.appendChild(r),this.locked=!1,!0},t.prototype.updateId=function(t,e){this.getElementWrapper(t).id=e,this.id=e},t.prototype.updateName=function(t){this.getElement().name=t,this.name=t},t.prototype.renderField=function(){throw new Error("renderField should be overidden by a widget subclass!")},t.prototype.renderWrapper=function(){var t=document.createElement("div");return t.setAttribute("id",this.id),t.className=this.getFieldWrapperClass(),t},t.prototype.renderLabel=function(){if(this.label){var t=document.createElement("label");return t.setAttribute("for",this.getFieldId()),t.setAttribute("class","mutt-label"),t.textContent=this.label,t}return null},t.prototype.renderHelp=function(){if(this.options.hasOwnProperty("help")&&this.options.help){var t=document.createElement("span");return t.setAttribute("class","mutt-help"),t.textContent=this.options.help,t}return null},t.prototype.renderErrors=function(){if(this.errors.length>0){var t=document.createElement("ul");t.className=this.getErrorClass();var e=this.errors,r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n,s=document.createElement("li");s.textContent=o,t.appendChild(s)}return t}return null},t.prototype.refreshErrorState=function(t){if(this.errors=t,this._rendered){var e=this.getElementWrapper(),r=this.getElementError(),i=this.getErrorWrapperClass();if(r&&(e.classList.remove(i),e.removeChild(r)),this.errors.length>0){e.classList.add(i);var n=this.renderErrors();n&&e.appendChild(n)}}},t.prototype.getElementWrapper=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t||(t=this.id),document.querySelector("#"+t)},t.prototype.getElement=function(){return this.getElementWrapper().querySelector(".mutt-field")},t.prototype.getElementError=function(){return this.getElementWrapper().querySelector(".mutt-error")},t.prototype.getElementLabel=function(){return this.getElementWrapper().querySelector(".mutt-label")},t.prototype.getValue=function(){if(!this._rendered)return this.value;var t=this.getElement();if(!t)throw new Error("Unable to get element!");return this.value=t.value,this.value},t.prototype.setValue=function(t){if(this.value=t,this._rendered){var e=this.getElement();e&&(e.value=this.value)}},t.prototype.getFieldClass=function(){return this.attribs.hasOwnProperty("class")?"mutt-field "+this.attribs.class:"mutt-field"},t.prototype.getFieldWrapperClass=function(){return"mutt-field-wrapper"},t.prototype.getErrorClass=function(){return"mutt-error"},t.prototype.getErrorWrapperClass=function(){return"mutt-error-wrapper"},t.prototype.getFieldId=function(){return this.name},t}(),ArrayInput=function(t){function e(){return classCallCheck(this,e),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(e,t),e.prototype.renderList=function(t){var e=document.createDocumentFragment(),r=this.renderWrapper();t.sort(function(t,e){return t.getSortOrder()-e.getSortOrder()});var i=t,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var s;if(n){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}var a=s.render();r.appendChild(a)}return e.appendChild(r),this._rendered=!0,e},e.prototype.render=function(){throw new Error("ArrayInput must render as a list - use renderList")},e.prototype.renderLabel=function(){throw new Error("ArrayInput does not support a label!")},e.prototype.getFieldClass=function(){return"mutt-field mutt-field-array"},e.prototype.getElement=function(){throw new Error("Unable to get element on an array field!")},e.prototype.getElementByIndex=function(t){return this.getElementWrapper().querySelector("#"+this.id+"_item_"+t)},e.prototype.addSlot=function(t){var e=t.render();this.getElementWrapper().appendChild(e),t.postRender()},e.prototype.removeSlot=function(){var t=this._field.slots.length,e=this.getElementByIndex(t);this.getElementWrapper().removeChild(e)},e.prototype.spliceSlot=function(t){var e=this.getElementByIndex(t);this.getElementWrapper().removeChild(e)},e}(Widget),ButtonWidget=function(t){function e(){return classCallCheck(this,e),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(e,t),e.prototype.renderField=function(){var t=document.createElement("button");for(var e in t.setAttribute("type","button"),t.setAttribute("class",this.getFieldClass()),this.attribs)t.setAttribute(e,this.attribs[e]);return t},e.prototype.getFieldClass=function(){return"mutt-field mutt-field-button"},e}(Widget),CheckboxInput=function(t){function e(){return classCallCheck(this,e),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(e,t),e.prototype.renderField=function(){var t=this,e=document.createElement("input");for(var r in e.setAttribute("name",this.name),e.setAttribute("id",this.getFieldId()),e.setAttribute("type","checkbox"),e.setAttribute("class",this.getFieldClass()),e.onchange=function(){t.setValue(!e.hasAttribute("checked"))},this.value&&e.setAttribute("checked","checked"),this.attribs)e.setAttribute(r,this.attribs[r]);return this._rendered=!0,e},e.prototype.getValue=function(){return this._rendered?!!this.getElement().hasAttribute("checked"):this.value},e.prototype.setValue=function(t){if(this.value=t,this._rendered){var e=this.getElement();if(e){var r=this.getElementLabel();this.value?(e.setAttribute("checked","checked"),r&&r.classList.add("mutt-field-checkbox-checked")):(e.removeAttribute("checked"),r&&r.classList.remove("mutt-field-checkbox-checked"))}}},e.prototype.getFieldClass=function(){return"mutt-field mutt-field-checkbox"},e.prototype.getFieldId=function(){return this.id+"-checkbox"},e}(Widget),CheckboxList=function(t){function e(r,i,n,o,s,a,l,u){classCallCheck(this,e);var d=possibleConstructorReturn(this,t.call(this,r,i,n,o,s,a,l,u));return d.value||(d.value=[]),d}return inherits(e,t),e.prototype.renderField=function(){var t=this,e=document.createElement("ul");e.setAttribute("id",this.getFieldId());var r=function(r){var i=document.createElement("li"),n=document.createElement("input");if(n.setAttribute("type","checkbox"),n.setAttribute("name",t.name),n.setAttribute("class",t.getFieldClass()),n.setAttribute("data-index",r),n.setAttribute("id",t.id+r),t.options.hasOwnProperty("choices")&&t.options.choices[r][1]){var o=document.createElement("label");o.setAttribute("for",t.id+r),o.textContent=t.options.choices[r][1],i.appendChild(o)}for(var s in n.onchange=function(){t.setValueByIndex(!n.hasAttribute("checked"),n.getAttribute("data-index"))},t.value&&t.value[r]&&n.setAttribute("checked","checked"),t.attribs)n.setAttribute(s,t.attribs[s]);i.appendChild(n),e.appendChild(i)};for(var i in this.choices)r(i);return this._rendered=!0,e},e.prototype.getValueByIndex=function(t){if(!this._rendered)return this.value[t];var e=this.getElementByIndex(t);if(!e)throw new Error("Unable to get element!");return e.hasAttribute("checked")?this.value=!0:this.value=!1,this.value},e.prototype.getValue=function(){if(!this._rendered)return this.value;var t=this.getAllElements();if(!t)throw new Error("Unable to get elements!");for(var e in Array.from(t))t[e].hasAttribute("checked")?this.value[e]=!0:this.value[e]=!1;return this.value},e.prototype.setValueByIndex=function(t,e){if(this.value[e]=t,this._rendered){var r=this.getElementByIndex(e);r&&(this.value[e]?r.setAttribute("checked","checked"):r.removeAttribute("checked"))}},e.prototype.setValue=function(t){if(this.value=t,this._rendered){var e=this.getAllElements();if(t.length!==e.length)throw new Error("Array Length does not match number of Elements in CheckboxList");for(var r in e[0].setAttribute("checked","checked"),Array.from(e))this.value[r]?e[parseInt(r)].setAttribute("checked","checked"):e[parseInt(r)].removeAttribute("checked")}},e.prototype.setChoices=function(t){for(var e in t)this.value&&void 0===this.value[e]&&(this.value[e]=!1);this.choices=t},e.prototype.getFieldId=function(){return this.id+"-checkbox"},e.prototype.getChoices=function(){return this.choices},e.prototype.getAllElements=function(){return this.getElementWrapper().querySelectorAll(".mutt-field")},e.prototype.getElementByIndex=function(t){return this.getElementWrapper().querySelectorAll(".mutt-field")[t]},e}(CheckboxInput),BaseChoiceWidget=function(t){function e(r,i,n,o,s,a,l,u){classCallCheck(this,e);var d=possibleConstructorReturn(this,t.call(this,r,i,n,o,s,a,l,u));return d.choices=[],d}return inherits(e,t),e.prototype.setChoices=function(t){this.choices=t},e.prototype.getChoices=function(){return this.choices},e.prototype.formatLabel=function(t){return t?""+(t=t.toLowerCase().replace("_"," ")).charAt(0).toUpperCase()+t.slice(1):t},e.prototype.renderField=function(){throw new Error("Unable to render abstract widget BaseChoiceInput!")},e}(Widget),DateInput=function(t){function e(){return classCallCheck(this,e),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(e,t),e.prototype.renderField=function(){var t=document.createElement("input");if(t.setAttribute("name",this.name),t.setAttribute("type","date"),t.setAttribute("value",this.value?this.value:""),t.setAttribute("class",this.getFieldClass()),this.options.hasOwnProperty("min"))if("now"===this.options.min){var e=new Date;t.setAttribute("min",e.toISOString().slice(0,-14))}else t.setAttribute("min",this.options.min);for(var r in this.attribs)t.setAttribute(r,this.attribs[r]);return t},e.prototype.getFieldClass=function(){return"mutt-field mutt-field-date"},e}(Widget),DateSelectionInput=function(t){function e(r,i,n,o,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;classCallCheck(this,e);var d=possibleConstructorReturn(this,t.call(this,r,i,n,o,s,a,l,null));return d.setDateValue(u),d}return inherits(e,t),e.prototype.renderField=function(){var t=document.createElement("div");t.setAttribute("class","mutt-date-selector");var e=this.getDateValue(),r=document.createElement("input");r.setAttribute("name",this.name),r.setAttribute("type","hidden"),r.setAttribute("value",this.value?this.value:""),t.appendChild(r);var i=document.createElement("select");i.setAttribute("name",this.name+"-day");var n=Array.from(Array(31).keys()),o=Array.isArray(n),s=0;for(n=o?n:n[Symbol.iterator]();;){var a;if(o){if(s>=n.length)break;a=n[s++]}else{if((s=n.next()).done)break;a=s.value}var l=a+1,u=document.createElement("option");u.setAttribute("value",("0"+l).slice(-2)),u.textContent=l,null!==e&&e.getDate()===l&&(u.selected="selected"),i.appendChild(u)}t.appendChild(i);var d=document.createElement("select");d.setAttribute("name",this.name+"-month");var h=this.getMonthNames();for(var c in h){var p=h[c],f=document.createElement("option"),y=parseInt(c)+1;y=("0"+y).slice(-2),f.setAttribute("value",y),f.textContent=p,null!==e&&e.getMonth()===parseInt(c)&&(f.selected="selected"),d.appendChild(f)}t.appendChild(d);var b=document.createElement("select");b.setAttribute("name",this.name+"-year");var v=(new Date).getFullYear(),m=v,g=20;for(this.options.hasOwnProperty("years")&&(g=this.options.years);m>v-g;){var A=document.createElement("option");A.setAttribute("value",m),A.textContent=m,null!==e&&e.getFullYear()===m&&(A.selected="selected"),b.appendChild(A),m--}return t.appendChild(b),t},e.prototype.getFieldClass=function(){return"mutt-field mutt-field-date-selector"},e.prototype.getElementDay=function(){return this.getElementWrapper().querySelector('[name="'+this.name+'-day"]')},e.prototype.getElementMonth=function(){return this.getElementWrapper().querySelector('[name="'+this.name+'-month"]')},e.prototype.getElementYear=function(){return this.getElementWrapper().querySelector('[name="'+this.name+'-year"]')},e.prototype.getMonthNames=function(){return["January","February","March","April","May","June","July","August","September","October","November","December"]},e.prototype.getDateValue=function(){if(!this._rendered)return this.value;var t=this.getElementDay(),e=this.getElementMonth(),r=this.getElementYear();if(!t||!e||!r)throw new Error("Unable to get element for date!");var i=r.value+"-"+e.value+"-"+t.value,n=Date.parse(i);if(isNaN(n))return this.value=null,this.value;var o=new Date(n);return this.value=o,this.value},e.prototype.setDateValue=function(t){if("string"==typeof t){var e=Date.parse(t);if(isNaN(e))return;t=new Date(e)}if(this.value=t,this._rendered){var r=this.getElementDay(),i=this.getElementMonth(),n=this.getElementYear(),o=t.getDate();1===o.toString().length&&(o="0"+o);var s=t.getMonth()+1;1===s.toString().length&&(s="0"+s),r&&i&&n&&(r.value=o,i.value=s,n.value=this.value.getFullYear())}},e.prototype.getValue=function(){return this.getDateValue()},e.prototype.setValue=function(t){this.setDateValue(t)},e}(Widget),NumberInput=function(t){function e(){return classCallCheck(this,e),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(e,t),e.prototype.renderField=function(){var t=document.createElement("input");for(var e in t.setAttribute("name",this.name),t.setAttribute("type","number"),t.setAttribute("inputmode","numeric"),t.setAttribute("class",this.getFieldClass()),t.setAttribute("value",null!==this.value?this.value:""),t.setAttribute("pattern","[0-9]*"),this.attribs)t.setAttribute(e,this.attribs[e]);return t},e.prototype.getFieldClass=function(){return"mutt-field mutt-field-number"},e}(Widget),CurrencyInput=function(t){function e(){return classCallCheck(this,e),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(e,t),e.prototype.renderField=function(){var t=document.createElement("input");for(var e in t.setAttribute("name",this.name),t.setAttribute("type","number"),t.setAttribute("inputmode","numeric"),t.setAttribute("class",this.getFieldClass()),t.setAttribute("value",null!==this.value?this.value:""),t.setAttribute("pattern","[0-9]*"),this.attribs)t.setAttribute(e,this.attribs[e]);return t},e.prototype.getValue=function(){var e=t.prototype.getValue.call(this);return e&&(e=(e=parseFloat(e)).toFixed(2)),parseFloat(e)},e.prototype.getFieldClass=function(){return"mutt-field mutt-field-currency"},e}(Widget),ObjectInput=function(t){function e(){return classCallCheck(this,e),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(e,t),e.prototype.renderObjectFields=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=[],n=Object.keys(e),o=Array.isArray(n),s=0;for(n=o?n:n[Symbol.iterator]();;){var a;if(o){if(s>=n.length)break;a=n[s++]}else{if((s=n.next()).done)break;a=s.value}var l=a;if(!r||Object.keys(r).includes(l)){var u=e[l];i.push([u.getSortOrder(),l])}}i.sort(function(t,e){return t[0]-e[0]});var d=i,h=Array.isArray(d),c=0;for(d=h?d:d[Symbol.iterator]();;){var p;if(h){if(c>=d.length)break;p=d[c++]}else{if((c=d.next()).done)break;p=c.value}var f=e[p[1]].render();t.appendChild(f)}},e.prototype.renderObject=function(t){var e=document.createDocumentFragment(),r=this.renderWrapper();if(this.options.fieldsets){var i=0,n=this.options.fieldsets,o=Array.isArray(n),s=0;for(n=o?n:n[Symbol.iterator]();;){var a;if(o){if(s>=n.length)break;a=n[s++]}else{if((s=n.next()).done)break;a=s.value}var l=a,u=document.createElement("fieldset");if(u.classList.add("mutt-fieldset"),u.setAttribute("name",this.name+"-fieldset-"+i),l.hasOwnProperty("options")&&l.options.hasOwnProperty("class")&&l.options.class)if(l.options.class.includes(" ")){var d=l.options.class.split(" "),h=Array.isArray(d),c=0;for(d=h?d:d[Symbol.iterator]();;){var p;if(h){if(c>=d.length)break;p=d[c++]}else{if((c=d.next()).done)break;p=c.value}var f=p;u.classList.add(f)}}else u.classList.add(l.options.class);this.renderObjectFields(u,t,l.fields),r.appendChild(u),i++}}else this.renderObjectFields(r,t);return e.appendChild(r),this._rendered=!0,e},e.prototype.render=function(){throw new Error("ObjectInput must render as a object - use renderObject")},e.prototype.renderLabel=function(){throw new Error("ObjectInput does not support a label!")},e.prototype.getFieldClass=function(){return"mutt-field mutt-field-object"},e}(Widget),RadioInput=function(t){function e(r,i,n,o,s,a,l,u){classCallCheck(this,e);var d=possibleConstructorReturn(this,t.call(this,r,i,n,o,s,a,l,u));return"boolean"===d.type&&(l.hasOwnProperty("choices")?d.choices=l.choices:d.choices=[[!0,"Yes"],[!1,"No"]]),d}return inherits(e,t),e.prototype.renderField=function(){var t=this,e=document.createElement("div"),r=0,i=this.choices,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var s;if(n){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}var a=s,l=a[0],u=a[1],d=this.id+"_"+r,h=document.createElement("div");h.setAttribute("class","mutt-field-radio-item");var c=document.createElement("input");if(c.setAttribute("id",d),c.setAttribute("type","radio"),c.setAttribute("name",this.id),c.setAttribute("value",l),c.setAttribute("class",this.getFieldClass()),this.options.hasOwnProperty("callback")&&(c.onclick=function(){return t.options.callback(t)}),this.attribs)for(var p in this.attribs)c.setAttribute(p,this.attribs[p]);this.value===l&&c.setAttribute("checked","checked");var f=document.createElement("label");f.setAttribute("for",d),f.textContent=this.formatLabel(u),h.appendChild(c),h.appendChild(f),e.appendChild(h),r++}return e},e.prototype.getRadioValue=function(){var t=this.getElementWrapper().querySelector(".mutt-field:checked");return t?(this.value=t.value,this.value):null},e.prototype.getValue=function(){return this.getRadioValue()},e.prototype.getFieldClass=function(){return"mutt-field mutt-field-radio"},e}(BaseChoiceWidget),SelectInput=function(t){function e(){return classCallCheck(this,e),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(e,t),e.prototype.renderField=function(){var t=document.createElement("select");for(var e in t.setAttribute("name",this.name),t.setAttribute("class",this.getFieldClass()),this.attribs)t.setAttribute(e,this.attribs[e]);var r=this.choices,i=Array.isArray(r),n=0;for(r=i?r:r[Symbol.iterator]();;){var o;if(i){if(n>=r.length)break;o=r[n++]}else{if((n=r.next()).done)break;o=n.value}var s=o,a=s[0],l=s[1],u=document.createElement("option");u.value=a,u.textContent=this.formatLabel(l),this.value===a&&u.setAttribute("selected","selected"),t.appendChild(u)}return t},e.prototype.getFieldClass=function(){return"mutt-field mutt-field-select"},e}(BaseChoiceWidget),TextInput=function(t){function e(){return classCallCheck(this,e),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(e,t),e.prototype.renderField=function(){var t=document.createElement("input");for(var e in t.setAttribute("name",this.name),t.setAttribute("type","text"),t.setAttribute("value",this.value?this.value:""),t.setAttribute("class",this.getFieldClass()),this.attribs)t.setAttribute(e,this.attribs[e]);return t},e.prototype.getFieldClass=function(){return"mutt-field mutt-field-text"},e}(Widget),TextAreaInput=function(t){function e(){return classCallCheck(this,e),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(e,t),e.prototype.renderField=function(){var t=document.createElement("textarea");for(var e in t.setAttribute("name",this.name),t.setAttribute("class",this.getFieldClass()),t.textContent=this.value?this.value:"",this.attribs)t.setAttribute(e,this.attribs[e]);return t},e.prototype.getFieldClass=function(){return"mutt-field mutt-field-text"},e}(Widget),EmailInput=function(t){function e(){return classCallCheck(this,e),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(e,t),e.prototype.renderField=function(){var t=document.createElement("input");for(var e in t.setAttribute("name",this.name),t.setAttribute("type","email"),t.setAttribute("value",this.value?this.value:""),t.setAttribute("class",this.getFieldClass()),this.attribs)t.setAttribute(e,this.attribs[e]);return t},e.prototype.getFieldClass=function(){return"mutt-field mutt-field-email"},e}(TextInput),HiddenInput=function(t){function e(r,i,n,o,s,a,l,u){classCallCheck(this,e);var d=possibleConstructorReturn(this,t.call(this,r,i,n,o,s,a,l,u));return d.choices=[],d}return inherits(e,t),e.prototype.renderField=function(){var t=document.createElement("input");for(var e in t.setAttribute("name",this.name),t.setAttribute("type","hidden"),t.setAttribute("value",this.value?this.value:""),t.setAttribute("class",this.getFieldClass()),this.attribs)t.setAttribute(e,this.attribs[e]);return t},e.prototype.renderLabel=function(){return null},e.prototype.renderErrors=function(){return null},e.prototype.setChoices=function(t){this.choices=t},e.prototype.getChoices=function(){return this.choices},e}(Widget),PasswordInput=function(t){function e(){return classCallCheck(this,e),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(e,t),e.prototype.renderField=function(){var t=document.createElement("input");for(var e in t.setAttribute("name",this.name),t.setAttribute("type","password"),t.setAttribute("value",this.value?this.value:""),t.setAttribute("class",this.getFieldClass()),this.attribs)t.setAttribute(e,this.attribs[e]);return t},e.prototype.getFieldClass=function(){return"mutt-field mutt-field-password"},e}(TextInput);function displayReadonlyValue(t){var e=document.createElement("span");return e.setAttribute("class","mutt-field mutt-field-display"),e.textContent=t,e}var DisplayWidget=function(t){function e(){return classCallCheck(this,e),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(e,t),e.prototype.renderField=function(){return displayReadonlyValue(this.value)},e.prototype.getFieldClass=function(){return"mutt-field mutt-field-display"},e}(Widget),widgets=Object.freeze({Widget:Widget,ArrayInput:ArrayInput,ButtonWidget:ButtonWidget,CheckboxInput:CheckboxInput,CheckboxList:CheckboxList,BaseChoiceWidget:BaseChoiceWidget,DateInput:DateInput,DateSelectionInput:DateSelectionInput,NumberInput:NumberInput,CurrencyInput:CurrencyInput,ObjectInput:ObjectInput,RadioInput:RadioInput,SelectInput:SelectInput,TextInput:TextInput,TextAreaInput:TextAreaInput,EmailInput:EmailInput,HiddenInput:HiddenInput,PasswordInput:PasswordInput,DisplayWidget:DisplayWidget}),MuttConfig=function(){function t(){classCallCheck(this,t),this._config={settings:{debug:!1},fields:{array:ArrayField,boolean:BooleanField,enum:ChoiceField,integer:IntegerField,object:ObjectField,string:StringField,date:StringField,datetime:StringField,button:ButtonField},widgets:{array:ArrayInput,checkbox:CheckboxInput,checkboxlist:CheckboxList,date:DateInput,dateselect:DateSelectionInput,number:NumberInput,currency:CurrencyInput,object:ObjectInput,radio:RadioInput,select:SelectInput,text:TextInput,textarea:TextAreaInput,email:EmailInput,hidden:HiddenInput,password:PasswordInput,display:DisplayWidget,button:ButtonWidget}}}return t.prototype.getSetting=function(t){return this._config.settings.hasOwnProperty(t)?this._config.settings[t]:null},t.prototype.setSetting=function(t,e){this._config.settings[t]=e},t.prototype.use=function(t){if(!t.hasOwnProperty("install"))throw new Error("Unable to install plugin - missing install!");var e={},r=t.install();if(Array.isArray(r)){var i=r[0],n=r[1],o=r[2];e={fields:i,widgets:n,settings:o}}else e=r;e.fields&&this.registerFields(e.fields),e.widgets&&this.registerWidgets(e.widgets),e.settings&&(this._config.settings=Object.assign(this._config.settings,e.settings)),e.extensions&&Object.keys(e.extensions).forEach(function(t){var r=e.extensions[t];MuttForm.prototype[t]=r})},t.prototype.registerField=function(t,e){this._config.fields[t]=e},t.prototype.registerFields=function(t){if(t){var e=Object.keys(t),r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;this.registerField(o,t[o])}}},t.prototype.hasField=function(t){return!!this._config.fields.hasOwnProperty(t)},t.prototype.getField=function(t){return this._config.fields.hasOwnProperty(t)?this._config.fields[t]:null},t.prototype.registerWidget=function(t,e){this._config.widgets[t]=e},t.prototype.registerWidgets=function(t){if(t){var e=Object.keys(t),r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;this.registerWidget(o,t[o])}}},t.prototype.hasWidget=function(t){return!!this._config.widgets.hasOwnProperty(t)},t.prototype.getWidget=function(t){return this._config.widgets.hasOwnProperty(t)?this._config.widgets[t]:null},t.prototype.getWidgets=function(t){return this._config.widgets},t}();function mixin(t,e){t=t.prototype,e=e.prototype,Object.getOwnPropertyNames(e).forEach(function(r){"constructor"!==r&&Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})}function logger(t){Mutt.config.getSetting("debug")&&console.log("Mutt :: ",t)}var validators=Object.freeze({Validator:Validator,RequiredValidator:RequiredValidator,BooleanRequiredValidator:BooleanRequiredValidator,BooleanTrueValidator:BooleanTrueValidator,LengthValidator:LengthValidator,IntegerValidator:IntegerValidator,RegexValidator:RegexValidator});function Mutt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&this.config.setSetting("debug",!0),void 0===t)throw new Error("You must specify a Schema!");return new MuttForm(t,e)}function initApi(t){var e=new MuttConfig;t.config=e,t.use=function(e){Array.isArray(e)||(e=[e]);var r=e,i=Array.isArray(r),n=0;for(r=i?r:r[Symbol.iterator]();;){var o;if(i){if(n>=r.length)break;o=r[n++]}else{if((n=r.next()).done)break;o=n.value}var s=o;t.config.use(s)}},t.logger=logger,t.mixin=mixin,t.fields=fields,t.widgets=widgets,t.validators=validators}initApi(Mutt),Mutt.version="1.8.0";export default Mutt;
